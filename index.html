<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loja - Adicionar ao Carrinho</title>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Burbank+Big+Condensed:wght@400;700&display=swap">
  <style>
    body {
      background-color: #3878cd;
      font-family: 'Burbank Big Condensed', sans-serif;
    }
    .navbar {
      justify-content: center;
    }
    .navbar-nav {
      display: flex;
      justify-content: center;
      width: 100%;
    }
    .navbar-nav .nav-link {
      color: white;
      font-size: 1.12rem;
      margin-left: 0.8rem;
      margin-right: 0.8rem;
      transition: background-color 0.3s, color 0.3s;
    }
    .navbar-nav .nav-link.active {
      font-weight: bold;
    }
    .navbar-nav .nav-link:hover {
      background-color: white;
      color: #00275a;
      font-size: 1.23rem;
    }
    .carousel {
      position: relative;
      width: 100%;
      max-height: 400px;
      overflow: hidden;
    }
    .carousel-inner img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .carousel-item {
      transition: transform 1s ease-in-out;
    }
    .carousel-control-prev,
    .carousel-control-next {
      width: 5%;
      background: rgba(0, 0, 0, 0.5);
    }
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
      background-image: none;
      border-radius: 50%;
    }
    .carousel-control-prev-icon::before,
    .carousel-control-next-icon::before {
      font-size: 2rem;
      color: white;
    }
    .card {
      position: relative;
      overflow: hidden;
      margin-bottom: 1.5rem;
      height: 400px;
    }
    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .card-body {
      padding: 10px;
      text-align: center;
      position: absolute;
      bottom: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      font-size: 1.12rem;
    }
    .card-body h5 {
      margin: 10px 0;
    }
    .card-footer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(56, 120, 205, 0.8);
      color: white;
      padding: 10px;
      text-align: center;
      z-index: 2;
    }
    .card-footer .btn {
      width: 100%;
      background: #3878cd;
      border: none;
      color: white;
      font-weight: bold;
    }
    .card-footer .btn:hover {
      background: #003c71;
    }
    .message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      display: none;
      font-size: 1.2rem;
      border-radius: 5px;
      z-index: 1000;
    }
    .message.success {
      background-color: green;
      color: white;
    }
    .message.error {
      background-color: red;
      color: white;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
    }
    .col-6 {
      flex: 0 0 50%;
      max-width: 50%;
      padding: 0.5rem;
    }
    .col-4 {
      flex: 0 0 33.33%;
      max-width: 33.33%;
      padding: 0.5rem;
    }
    .col-3 {
      flex: 0 0 25%;
      max-width: 25%;
      padding: 0.5rem;
    }
    .col-2 {
      flex: 0 0 20%;
      max-width: 20%;
      padding: 0.5rem;
    }
    @media (max-width: 1200px) {
      .col-3 {
        flex: 0 0 33.33%;
        max-width: 33.33%;
      }
    }
    @media (max-width: 992px) {
      .col-4 {
        flex: 0 0 50%;
        max-width: 50%;
      }
    }
    @media (max-width: 768px) {
      .col-6 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }
    .navbar-bottom {
      display: flex;
      justify-content: center;
      background-color: #0049b7;
      padding: 10px 0;
    }
    .navbar-bottom .nav-link {
      color: white;
      font-size: 1rem;
      margin: 0 1rem;
    }
    .navbar-bottom .nav-link:hover {
      background-color: #003c71;
    }
    .navbar-bottom .nav-link.active {
      font-weight: bold;
    }
    .navbar-bottom .nav-item {
      margin-right: 1rem;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Jogar</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Passe de Batalha</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Competir</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="vestiario.html">Vestiário</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Loja de Itens</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="carrinho.html">Carrinho</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">V-Bucks 
              <img src="https://purepng.com/public/uploads/thumbnail//one-v-buck-90b.png" alt="V-Bucks" style="height: 24px; vertical-align: middle;" />
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  
  <div class="navbar-bottom">
    <a class="nav-link" href="#">Apoie o Criador</a>
    <a class="nav-link" href="#">Segure para Manter o Bate-Papo</a>
  </div>
  
  <div id="carouselExample" class="carousel slide">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="./flyer/banner1.png" class="d-block w-100" alt="Imagem 1">
      </div>
      <div class="carousel-item">
        <img src="./flyer/banner2.png" class="d-block w-100" alt="Imagem 2">
      </div>
      <div class="carousel-item">
        <img src="./flyer/banner3.png" class="d-block w-100" alt="Imagem 3">
      </div>
    </div>
    <a class="carousel-control-prev" href="#carouselExample" role="button" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExample" role="button" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </a>
  </div>

  <nav class="navbar navbar-expand navbar-bottom">
    <div class="container">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('todos')">Todos</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('icones')">Ícones</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('jogos')">Jogos</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('marvel')">Marvel</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('dc')">DC</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="filtrarProdutos('padrao')">Padrão</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="message" id="message"></div>

  <div class="container mt-4">
    <div id="products-container" class="row">
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetchProducts('todos');
    });

    function fetchProducts(category) {
      fetch('./db.json')
        .then(response => response.json())
        .then(data => {
          const products = category === 'todos' ? data.products : data.products.filter(p => p.cat === category);
          const container = document.getElementById('products-container');
          container.innerHTML = '';
          products.forEach(product => {
            container.innerHTML += `
              <div class="col-4 mb-4">
                <div class="card">
                  <img src="${product.image}" alt="${product.title}">
                  <div class="card-body">
                    <h5>${product.title}</h5>
                    <p>R$ ${product.price.toFixed(2)}</p>
                  </div>
                  <div class="card-footer">
                    <button class="btn btn-primary" onclick="addToCart('${product.id}')">Adicionar ao Carrinho</button>
                  </div>
                </div>
              </div>
            `;
          });
        })
        .catch(error => console.error('Erro ao carregar produtos:', error));
    }

    function addToCart(productId) {
      fetch('./db.json')
        .then(response => response.json())
        .then(data => {
          const product = data.products.find(p => p.id === productId);
          if (product) {
            let cart = JSON.parse(localStorage.getItem('carrinho')) || [];
            const existingProduct = cart.find(item => item.id === productId);
            if (existingProduct) {
              existingProduct.quantidade += 1; 
            } else {
              product.quantidade = 1; 
              cart.push(product);
            }
            localStorage.setItem('carrinho', JSON.stringify(cart));
            showMessage('Produto adicionado ao carrinho com sucesso!', 'success');
            setTimeout(() => {
              window.location.href = 'carrinho.html';
            }, 1500); 
          } else {
            showMessage('Erro ao adicionar produto ao carrinho.', 'error');
          }
        })
        .catch(error => {
          console.error('Erro ao adicionar produto ao carrinho:', error);
          showMessage('Erro ao adicionar produto ao carrinho.', 'error');
        });
    }


    function showMessage(text, type) {
      const message = document.getElementById('message');
      message.textContent = text;
      message.className = `message ${type}`;
      message.style.display = 'block';
      setTimeout(() => {
        message.style.display = 'none';
      }, 2000);
    }

    function filtrarProdutos(categoria) {
      fetchProducts(categoria);
    }
  </script>
</body>
</html>
